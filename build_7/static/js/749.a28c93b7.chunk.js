"use strict";(self.webpackChunkDidi_Kitchen=self.webpackChunkDidi_Kitchen||[]).push([[749],{7749:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var s=a(7051),l=a(5043),o=a(3326),r=a(1094),n=a(3216),d=a(9722),c=a(1036),i=a(184),m=a(1899),x=a.n(m),h=a(4999),p=a.n(h),u=a(3488),g=a.n(u),b=a(579);const j=()=>{const[e]=(0,l.useState)([]),t=(0,n.Zp)(),[a,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)(e),[j,y]=(0,l.useState)(!1),[N,w]=(0,l.useState)({chart:{type:"column"},title:{text:"Total Sale Details Based on City"},xAxis:{type:"category"},yAxis:{title:{text:"Total Amount Sold ( \u20b9 )"},gridLineWidth:0,lineWidth:1},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y}"}}},tooltip:{headerFormat:"<span style='font-size:11px'>{series.name}</span><br>",pointFormat:"<span style='color:{point.color}'>{point.name}</span>: <b>{point.y}</b><br/>"},series:[],drilldown:{series:[]}}),f=async()=>{const e={from_date:A,to_date:_};d.A.post("".concat("https://didikadhababackend.indevconsultancy.in/dhaba","/api_didi_payments/"),e).then((e=>{if(200==e.status){const t=e.data,a=["#F39E60","#7C444F","#E16A54"],l="#F39E60",o=t.series.map(((e,t)=>({name:e.name,colorByPoint:!0,data:e.data.map(((e,t)=>({name:e.name,y:e.y,drilldown:e.drilldown,color:a[t%a.length]})))}))),r=t.drilldown.map((e=>({id:e.id,data:e.data.map(((e,t)=>({name:e[0],y:e[1],color:l})))})));w((e=>(0,s.A)((0,s.A)({},e),{},{series:o,drilldown:{series:r}})))}})).catch((e=>{console.log("error in graph",e)}))},v=e=>{if(!e)return null;const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)},C=e=>{const t=new Date(e);return t.setDate(t.getDate()+1),t},S=e=>{const t=new Date(e);return t.setDate(t.getDate()-1),t},[A,F]=(0,l.useState)(v(S(new Date))),[_,D]=(0,l.useState)(v(C(new Date))),P=(e,t)=>{const a=v(e);"selectedFromDate"===t?_&&new Date(a)>new Date(_)?c.oR.error("From Date cannot be later than To Date."):F(a):"selectedToDate"===t&&(A&&new Date(A)>new Date(a)?c.oR.error("To Date cannot be earlier than From Date."):D(a))},k=async()=>{if(!A&&!_)return void c.oR.error("select date !");const e={from_date:A,to_date:_};m(!0),await d.A.post("".concat("https://didikadhababackend.indevconsultancy.in/dhaba","/didi_thela_summary_by_date/"),e).then((e=>{var t,a,s,l;const o=e.data.List.sort(((e,t)=>new Date(t.date)-new Date(e.date)));m(!1),u(o),R(null===(t=e.data)||void 0===t?void 0:t.total_payment_sum),T(null===(a=e.data)||void 0===a?void 0:a.remuneration),E(null===(s=e.data)||void 0===s?void 0:s.total_issued_food_cost),z(null===(l=e.data)||void 0===l?void 0:l.total_returned_food_cost)})),m(!1)};(0,l.useEffect)((()=>{k(),f()}),[]);const[L,R]=(0,l.useState)(0),[H,T]=(0,l.useState)(0),[B,E]=(0,l.useState)(0),[M,z]=(0,l.useState)(0),I=(0,l.useMemo)((()=>[{Header:"S. No.",Cell:e=>{let{row:t}=e;return t.index+1}},{Header:"Payment  Date",accessor:"date",Cell:e=>{let{row:t}=e;const a=t.original.date;return a?a.split("-").reverse().join("-"):"N/A"}},{Header:"Didi Name",accessor:"full_name",Cell:e=>{let{row:t}=e;const a=t.original.full_name;return a?a.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):"N/A"}},{Header:"Stall Location",accessor:"city"},{Header:"Amount Sold ( \u20b9 )",accessor:"total_payment",Cell:e=>{let{row:t}=e;const a=t.original.total_payment;return a?"\u20b9 ".concat(a.toLocaleString()):"N/A"}},{Header:"Remuneration ( \u20b9 )",accessor:"remuneration",Cell:e=>{let{row:t}=e;const a=t.original.remuneration;return a?"\u20b9 ".concat(a.toLocaleString()):"N/A"}},{Header:"Plate-wise ( \u20b9 )",accessor:"plate_total_price",Cell:e=>{let{row:t}=e;const a=t.original.plate_total_price;return a?"\u20b9 ".concat(Math.floor(a).toLocaleString()):"N/A"}},{Header:"Quantity-wise ( \u20b9 )",accessor:"food_total_price",Cell:e=>{let{row:t}=e;const a=t.original.food_total_price;return a?"\u20b9 ".concat(Math.floor(a).toLocaleString()):"N/A"}},{Header:"Color Code",accessor:"color",Cell:e=>{let{row:t}=e;const a=t.original.percentage_difference;var s="";return a<=-20?s="bg-[#FF0000]":a<-10&&a>-20?s="bg-[#FFFF00]":a<=0&&a>-10?s="bg-[#4BB543]":a>0&&(s="bg-[#FFA500]"),(0,b.jsxs)("div",{className:"p-1 border border ".concat(s," font-semibold text-slate-950"),children:[a," %"]})}},{Header:"View",Cell:e=>{let{row:a}=e;return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("button",{onClick:()=>t("/admin/".concat(a.original.didi_id,"/").concat(a.original.date)),className:"text-center w-full",children:(0,b.jsx)("i",{className:"fas fa-eye"})})})}}]),[t]),{getTableProps:U,getTableBodyProps:W,headerGroups:O,prepareRow:V,page:G,canNextPage:K,canPreviousPage:Z,nextPage:Q,previousPage:Y,gotoPage:q,setPageSize:J,pageCount:X,state:{pageIndex:$,pageSize:ee}}=(0,r.useTable)({columns:I,data:h,initialState:{pageIndex:0,pageSize:10}},r.useGlobalFilter,r.useSortBy,r.usePagination),te=l.forwardRef(((e,t)=>{let{value:a,onClick:s}=e;return(0,b.jsxs)("div",{className:"flex items-center border border-gray-300 py-1 px-3 rounded w-full cursor-pointer",onClick:s,ref:t,children:[(0,b.jsx)("input",{type:"text",value:a,readOnly:!0,placeholder:"Enter from date",className:"w-full focus:outline-none"}),(0,b.jsx)(i.bfZ,{className:"ml-2 text-gray-500"})]})}));(0,l.useEffect)((()=>{if(j){(async()=>{await k(),await f(),y(!1)})()}}),[j]);return(0,b.jsxs)("div",{children:[(0,b.jsx)(c.N9,{}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"col-md-1 d-flex align-items-center justify-content-start",children:(0,b.jsx)("span",{children:"From Date "})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)(x(),{selected:A,onChange:e=>P(e,"selectedFromDate"),dateFormat:"dd/MM/yyyy",customInput:(0,b.jsx)(te,{})})}),(0,b.jsx)("div",{className:"col-md-1 d-flex align-items-center justify-content-start",children:(0,b.jsx)("span",{children:"To Date "})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)(x(),{selected:_,onChange:e=>P(e,"selectedToDate"),dateFormat:"dd/MM/yyyy",customInput:(0,b.jsx)(te,{})})}),(0,b.jsx)("div",{className:"col-md-1"}),(0,b.jsx)("div",{className:"col-md-1",children:(0,b.jsx)("button",{onClick:()=>{const e={from_date:A,to_date:_};d.A.post("".concat("https://didikadhababackend.indevconsultancy.in/dhaba","/download_details/"),e,{responseType:"blob"}).then((e=>{if(200===e.status){const t=new Blob([e.data],{type:"text/csv;charset=utf-8;"});console.log("CSV Blob Created:",t);const a=new FileReader;a.onload=()=>{console.log("CSV Content Preview:",a.result)},a.readAsText(t);const s=window.URL.createObjectURL(t),l=document.createElement("a");l.href=s;const o=e.headers["content-disposition"];let r="downloaded_file.csv";if(o){const e=o.match(/filename="(.+)"/);e&&e[1]&&(r=e[1])}l.download=r,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(s)}})).catch((e=>{console.error("Error in downloading CSV:",e)}))},style:{borderColor:"#682c13",color:"#682c13"},className:"btn flex items-center px-4 py-2",children:(0,b.jsx)(i.WCW,{className:"mr-2"})})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)("button",{type:"reset",className:"btn btn-primary w-100 py-1",style:{backgroundColor:"#682c13",borderColor:"#682c13"},onClick:async()=>{await k(),await f()},disabled:a,children:a?(0,b.jsx)("span",{children:"loading...."}):(0,b.jsx)("span",{children:"Search"})})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)("button",{type:"reset",className:"btn btn-dark w-full py-1",onClick:async()=>{const e=v(S(new Date)),t=v(C(new Date));F(e),D(t),y(!0)},disabled:a,children:a?(0,b.jsx)("span",{children:"loading...."}):(0,b.jsx)("span",{children:"Reset"})})})]}),(0,b.jsxs)("div",{className:"row my-2",children:[(0,b.jsxs)("div",{className:"col-md-6",children:[(0,b.jsxs)("div",{className:"row mb-2",children:[(0,b.jsx)("div",{className:"col-md-6",children:(0,b.jsxs)("div",{className:"text-xl font-semibold text-gray-800",children:["Sale: \u20b9"," ",(0,b.jsx)("span",{className:"text-lg font-bold text-[#A24C4A]",children:L.toLocaleString()})]})}),(0,b.jsx)("div",{className:"col-md-6",children:(0,b.jsxs)("div",{className:"text-xl font-semibold text-gray-800",children:["Remuneration: \u20b9"," ",(0,b.jsx)("span",{className:"text-lg font-bold text-[#A24C4A]",children:H.toLocaleString()})]})})]}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"col-md-6",children:(0,b.jsxs)("div",{className:"text-xl font-semibold text-gray-800",children:["Issued Food: \u20b9"," ",(0,b.jsx)("span",{className:"text-lg font-bold text-[#A24C4A]",children:Number(Number(B).toFixed()).toLocaleString()})]})}),(0,b.jsx)("div",{className:"col-md-6",children:(0,b.jsxs)("div",{className:"text-xl font-semibold text-gray-800",children:["Returned Food: \u20b9"," ",(0,b.jsx)("span",{className:"text-lg font-bold text-[#A24C4A]",children:Number(Number(M).toFixed()).toLocaleString()})]})})]})]}),(0,b.jsxs)("div",{className:"col-md-6 ",children:[(0,b.jsx)("div",{className:"row mt-3"}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"col-md-4"}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)("div",{className:"border rounded-lg bg-[#FFA500] font-semibold text-slate-950 text-center py-1",title:"<0%",children:"< 0%"})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)("div",{className:"border rounded-lg bg-[#4BB543] font-semibold text-slate-950 text-center py-1",title:"0-10%",children:"0-10%"})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)("div",{className:"border rounded-lg bg-[#FFFF00] font-semibold text-slate-950 text-center py-1",title:"10-20%",children:"10-20%"})}),(0,b.jsx)("div",{className:"col-md-2",children:(0,b.jsx)("div",{className:"border rounded-lg bg-[#FF0000] font-semibold text-slate-950 text-center py-1",title:">20%",children:"> 21%"})})]})]})]}),a?(0,b.jsx)(b.Fragment,{children:"loading..."}):(0,b.jsxs)(b.Fragment,{children:[" ",(0,b.jsx)("div",{className:"overflow-auto",children:(0,b.jsxs)("table",(0,s.A)((0,s.A)({},U()),{},{className:"w-full table table-bordered table-hover",children:[(0,b.jsx)("thead",{children:O.map((e=>(0,b.jsx)("tr",(0,s.A)((0,s.A)({},e.getHeaderGroupProps()),{},{children:e.headers.map((e=>(0,b.jsxs)("th",(0,s.A)((0,s.A)({},e.getHeaderProps(e.getSortByToggleProps())),{},{className:"p-2 cursor-pointer text-md font-normal border border-1",style:{backgroundColor:"#682C13",color:"white"},children:[e.render("Header"),(0,b.jsx)("span",{children:e.isSorted?e.isSortedDesc?(0,b.jsx)("span",{className:"ml-2 border p-1 rounded text-white",children:(0,b.jsx)("i",{className:"fa",children:"\uf150"})}):(0,b.jsx)("span",{className:"ml-2 border p-1 rounded text-white",children:(0,b.jsx)("i",{className:"fa",children:"\uf0d8"})}):""})]}))))}))))}),(0,b.jsx)("tbody",(0,s.A)((0,s.A)({},W()),{},{children:G.length>0?G.map((e=>(V(e),(0,b.jsx)("tr",(0,s.A)((0,s.A)({},e.getRowProps()),{},{className:"hover:bg-gray-100",children:e.cells.map((e=>(0,b.jsx)("td",(0,s.A)((0,s.A)({},e.getCellProps()),{},{className:"border text-slate-600 border border-1 py-0 pl-2 m-0",style:{color:"#5E6E82"},children:e.render("Cell")}))))}),e.id)))):(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:I.length,className:"p-2 text-center text-slate-600",children:"No Data Available"})})}))]}))}),h.length>0&&(0,b.jsx)(o.A,{canNextPage:K,pageIndex:$,pageSize:ee,pageCount:X,gotoPage:q,nextPage:Q,previousPage:Y,setPageSize:J})]}),(0,b.jsx)("div",{className:"mt-2 bg-white p-2 bg-white",children:(0,b.jsx)(p(),{highcharts:g(),options:N})})]})}}}]);
//# sourceMappingURL=749.a28c93b7.chunk.js.map